resources:
- name: vampire-editor-repo
  type: git
  source:
    uri: https://github.com/Antafes/Vampire-Editor
    branch: concourse-test
- name: vampire-editor-pre-release
  type: github-release
  source:
    owner: Antafes
    repository: Vampire-Editor
    pre_release: true
- name: vampire-editor-release
  type: github-release
  source:
    owner: Antafes
    repository: Vampire-Editor
    release: true
- name: myXML-lib
  type: github-release
  source:
    owner: Antafes
    repository: MyXML
    release: true

jobs:
- name: vampire-editor-dev
  plan:
  - get: vampire-editor-release
  - get: vampire-editor-repo
    trigger: true
  - get: myXML-lib
  - task: build
    config:
      platform: linux
      image_resource:
        type: docker-image
        source:
          repository: frekele/ant
          tag: 1.10-jdk8
      inputs:
      - name: vampire-editor-release
      - name: vampire-editor-repo
      - name: myXML-lib
      outputs:
      - name: dist
      run:
        path: ci/build.sh
        dir: vampire-editor-repo
  - put: vampire-editor-pre-release
    params:
     name: dist/name
     tag: dist/tag
     globs:
      - dist/VampireEditor.zip
- name: vampire-editor
  plan:
  - get: vampire-editor-release
    trigger: true
  - get: myXML-lib
  - task: build
    config:
      platform: linux
      image_resource:
        type: docker-image
        source:
          repository: frekele/ant
          tag: 1.10-jdk8
      inputs:
      - name: vampire-editor-release
      - name: myXML-lib
      outputs:
      - name: dist
      run:
        path: ci/build.sh
        dir: vampire-editor-release
  - put: vampire-editor-release
    params:
      name: dist/name
      tag: dist/tag
      globs:
      - dist/VampireEditor.zip